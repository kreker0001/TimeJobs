{% extends "base.html" %}
{% block title %}Все вакансии — Time Jobs{% endblock %}

{% block content %}
<div class="profile-page">
    <div class="profile-inner">

        <div class="profile-hero">
            <div class="profile-hero-left">
                <div>
                    <h1 class="text-18-600" style="font-size: 24px;">Все вакансии</h1>
                    <p class="profile-text" style="font-size: 13px; color: hsl(var(--twc-grey-400));">
                        Найдите подходящую смену или исполнителя.
                    </p>
                </div>
            </div>

            <div class="profile-hero-right" style="gap: 10px;">
                <form method="get" action="{{ url_for('vacancies') }}" style="display: flex; gap: 10px; width: 100%; max-width: 360px;">
                    <input type="text" name="search"
                        value="{{ request.args.get('search', '') if request else '' }}"
                        placeholder="Поиск по названию, городу, навыкам..."
                        class="profile-input"
                        style="flex: 1;">

                    <button type="submit" class="ra-button preset primary">
                        Найти
                    </button>
                </form>
            </div>
        </div>

        {% if jobs %}
        <div class="vacancies-grid" style="
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(310px, 1fr));
            gap: 20px;
            margin-top: 20px;
        ">
            {% for job in jobs %}
            <a href="{{ url_for('vacancy_detail', job_id=job.id) }}"
               class="glass-card"
               style="
                    padding: 18px 20px;
                    border-radius: 18px;
                    color: white;
                    text-decoration: none;
                    display: block;
                    border: 1px solid rgba(255,255,255,0.06);
               ">

                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
                    <h2 class="text-18-600" style="font-size: 17px; font-weight: 600;">{{ job.title }}</h2>

                    {% if job.status %}
                        <span class="tag"
                              style="
                                font-size: 11px;
                                padding: 4px 8px;
                                border-radius: 8px;
                                border: 1px solid rgba(255,255,255,0.1);
                                {% if job.status == 'approved' %}
                                  background: rgba(76, 250, 0, 0.16);
                                  color: #4CFA00;
                                  border-color: rgba(76,250,0,0.35);
                                {% elif job.status == 'pending' %}
                                  background: rgba(250, 200, 0, 0.16);
                                  color: #FACC15;
                                  border-color: rgba(250,200,0,0.35);
                                {% else %}
                                  background: rgba(148,163,184,0.18);
                                  color: #A8B3CF;
                                  border-color: rgba(148,163,184,0.35);
                                {% endif %}
                              ">
                            {{ job.status }}
                        </span>
                    {% endif %}
                </div>

                <p class="profile-text" style="font-size: 13px; margin-bottom: 8px; color: hsl(var(--twc-grey-400));">
                    {{ job.city or 'Город не указан' }}
                    {% if job.specialization %} • {{ job.specialization }}{% endif %}
                </p>

                <p class="profile-text" style="font-size: 14px; color: hsl(var(--twc-grey-200)); margin-top: 6px;">
                    {{ job.description[:160] }}{% if job.description and job.description|length > 160 %}…{% endif %}
                </p>

                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 14px;">
                    <div style="color: var(--tj-accent); font-weight: 600;">
                        {{ '%.0f'|format(job.wage or 0) }} ₽
                        <span style="color: hsl(var(--twc-grey-400)); font-size: 11px;">
                            {% if job.pay_type == 'hourly' %}/ час{% else %}/ смена{% endif %}
                        </span>
                    </div>

                    <div class="ra-button preset default" style="padding: 4px 14px; font-size: 12px;">
                        Подробнее
                    </div>
                </div>

            </a>
            {% endfor %}
        </div>

        {% else %}
        <div class="glass-card" style="
            padding: 20px;
            border-radius: 18px;
            margin-top: 20px;
            color: hsl(var(--twc-grey-200));
            border: 1px solid rgba(255,255,255,0.06);
        ">
            Пока нет вакансий. Попробуйте позже или создайте первую вакансию.
        </div>
        {% endif %}

    </div>
</div>
{% endblock %}
